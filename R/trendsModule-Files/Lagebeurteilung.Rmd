---
title: "Epidemiologische Lagebeurteilung" 
author: "Swiss National COVID-19 Science Task Force"
date: "`r format(Sys.time(), '%d.%m.%Y')`"
output:
  word_document: default
  html_document:
    df_print: paged
  pdf_document: default
---

```{r libraries, echo = FALSE, message = FALSE}
library(tidyverse)
library(lubridate)
library(glue)
library(here)
```

```{r load, echo = FALSE}
eventCounts <- qs::qread(here("data", "trends-eventCounts.qs")) %>% bind_rows()
ranking <- qs::qread(here("data", "trends-ranking.qs"))
incidenceTable <- qs::qread(here("data", "trends-incidenceTable.qs"))
popSizes <- read_csv(here("data", "popSizes.csv"),
  col_types = cols(.default = col_character(), year = col_double(), populationSize = col_double())) %>%
  mutate(region = recode(region, "LI" = "FL"))
```

```{r national, echo = FALSE}
reFiles <- c(here("data", "Re", "CHE-Estimates.rds"), here("data", "RePublic", "CHE-Estimates.rds"))
mostRecentReFile <- reFiles[which.max(file.mtime(reFiles))]

reproduction <- readRDS(mostRecentReFile)

r_cases <- subset(reproduction,
                  region == "CHE"
                  & data_type == "Confirmed cases"
                  & estimate_type == "Cori_slidingWindow")
r_cases_timeDeath <- r_cases
r_cases_timeHosp <- r_cases
r_cases <- r_cases[r_cases$date == max(r_cases$date), ]

r_mean7d <- reproduction %>%
  filter(region == "CHE",
    data_type == "Confirmed cases",
    estimate_type == "Cori_step") %>%
  filter(date == max(date))

r_mean7d_dateRange_str <- str_c(format(r_mean7d$date - 6, "%d.%m."), " - ", format(r_mean7d$date, "%d.%m.%Y"))

r_hosp <- subset(reproduction,
                  region == "CHE"
                  & data_type == "Hospitalized patients"
                  & estimate_type == "Cori_slidingWindow")
r_hosp_timeDeath <- r_hosp

r_hosp <- r_hosp[r_hosp$date == max(r_hosp$date), ]
r_cases_timeHosp <- r_cases_timeHosp[r_cases_timeHosp$date == max(r_hosp$date), ]
  
r_deaths <- subset(reproduction,
                  region == "CHE"
                  & data_type == "Deaths"
                  & estimate_type == "Cori_slidingWindow")
r_deaths <- r_deaths[r_deaths$date == max(r_deaths$date), ]
r_hosp_timeDeath <- r_hosp_timeDeath[r_hosp_timeDeath$date == max(r_deaths$date), ]
r_cases_timeDeath <- r_cases_timeDeath[r_cases_timeDeath$date == max(r_deaths$date), ]

r_tests <- subset(reproduction,
                  region == "CHE"
                  & data_type == "Confirmed cases / tests"
                  & estimate_type == "Cori_slidingWindow")
r_tests <- r_tests[r_tests$date == max(r_tests$date), ]
```

```{r numbers, echo = FALSE}
# ICU numbers

delete_icu <- 0
delete <- delete_icu
time_window <- 14
lastday <- today()
begin <- lastday - delete + 1 - time_window
end <- lastday - delete

icu <- eventCounts %>%
  filter(event == "icu", region == "CH", age_class == "all") %>%
  filter(date >= begin & date <= end)

# Daily deaths
delete_death <- 5
delete <- delete_death
begin <- lastday - delete + 1 - time_window
end <- lastday - delete

deaths <- eventCounts %>%
  filter(event == "deaths", region == "CH", age_class == "all") %>%
  filter(date >= begin & date <= end)

# cumulative Cases / 100'000
cases14d <- incidenceTable %>% filter(event == "cases", age_class == "all") %>%
  left_join(select(popSizes, region, regionName), by = "region")

# for printing:
cases14d_CH <- cases14d %>%
  filter(region == "CH")
cases14d_max <- cases14d %>%
  filter(valueNorm14daySum == max(cases14d$valueNorm14daySum))
cases14d_min <- cases14d %>%
  filter(valueNorm14daySum == min(cases14d$valueNorm14daySum))

```

```{r tests, echo = FALSE}
testsFiles <- c(here("data", "Re", "CHE-Tests.rds"), here("data", "RePublic", "CHE-Tests.rds"))
mostRecentTestsFile <- testsFiles[which.max(file.mtime(testsFiles))]

tests <- readRDS(mostRecentTestsFile) %>%
  mutate(
    testPositivityP = testPositivity * 100,
    weekend = ifelse(wday(date) == 1 | wday(date) == 7, 1, 0))
mostRecentTestsCHE <- filter(tests,
  region == "CHE",
  date > max(date) - 14)
testReportingOffset <- 3 # number of days in the past to report n Tests.
mostRecentTestPositivity <- filter(tests,
  region == "CHE",
  date == max(date) - testReportingOffset)
positivityLm <- lm(testPositivity ~ date + weekend, data = mostRecentTestsCHE)
positivityTrend <- if_else(coef(positivityLm)[2] >= 0, "zunehmend", "abnehmend")
```

```{r percentChange, echo = FALSE}
rankingCHE <- ranking %>%
  filter(region == "CH", age_class == "all")

rankingCHEcases <- filter(rankingCHE, event == "cases")
rankingCHEhospitalizations <- filter(rankingCHE, event == "hospitalizations")
rankingCHEdeaths <- filter(rankingCHE, event == "deaths")
rankingCHEicu <- filter(rankingCHE, event == "icu")
```

```{r mortality, echo = FALSE}
# Death based on FOPH data
deaths_total <- eventCounts %>%
  filter(event == "deaths", region == "CH", age_class == "all", date >= "2020-10-01") %>%
  pull(count) %>%
  sum() 

# Cantonal deaths based on openZH
corona_data <- read.csv("https://raw.githubusercontent.com/daenuprobst/covid19-cases-switzerland/master/covid19_fatalities_switzerland_openzh.csv")
corona_data$Date <- ymd(corona_data$Date)
corona_data_date <- tail(corona_data$Date, 1)
corona_data_deaths <- tail(corona_data$CH, 1) - corona_data$CH[corona_data$Date == ymd(20200930)]
```

```{r variants, echo = FALSE, warning = FALSE, message = FALSE}

variants <- read_csv(here("www/variant-plot/variantPlot_data.csv")) %>%
  mutate(
    weekStartDate = parse_date_time(str_c(year, if_else(year == 2020, week-1, week), 1, sep = "-"), "Y-U-w")
  ) %>%
  # discard current week
  filter(
    year_week != str_c(year(today()), "-", isoweek(today()))
  )

mostRecentb117 <- variants %>%
  filter(
    lab == "Total",
    variant == "b117",
    year == max(year)) %>%
  filter(week == max(week))

mostRecents501yv2 <- variants %>%
  filter(
    lab == "Total",
    variant == "s501yv2",
    year == max(year)) %>%
  filter(week == max(week))

```

```{r printFuns, echo = FALSE}

valueUI <- function(value, lower, upper, uiText = "UI", uiSep = "-", unit = "", digits = 2) {
  if (uiText == "") {
    uiTextPrint <- ""
  } else {
    uiTextPrint <- str_c(uiText, ": ")
  }
  glue(
    "{format(round(value, digits), decimal.mark = ',')}{unit} ",
    "({uiTextPrint}{format(round(lower, digits), decimal.mark = ',')}{unit}",
    "{uiSep}",
    "{format(round(upper, digits), decimal.mark = ',')}{unit})"
  )
}

reDigits <- 2
percentDigits <- 0
positivityDigits <- 1

valueUIr <- function(df, uiText = "95% UI", uiSep = "-", unit = "", digits = reDigits) {
  valueUI(df$median_R_mean, df$median_R_lowHPD, df$median_R_highHPD,
    uiText = uiText, uiSep = uiSep, unit = unit, digits = digits)
}
valueUIchange <- function(df, uiText = "UI", uiSep = " bis ", unit = "%", digits = percentDigits) {
  valueUI(df$estimate * 100, df$lower * 100, df$upper * 100,
    uiText = uiText, uiSep = uiSep, unit = unit, digits = digits)
}
```


## Allgemeine Situation

In der Schweiz zirkulieren verschiedene Stämme von SARS-CoV-2 unter welchen B.1.1.7 dominiert. Die allgemeinen epidemiologischen Parameter – Fallzahlen, Hospitalisationen, Intensivstation-Belegung, Todesfälle – geben eine Gesamtsicht, ohne zwischen einzelnen Stämmen zu unterscheiden.
Insgesamt deuten all diese Indikatoren auf eine rückläufige Epidemie hin.
<!------ UPDATE  -------->
Daten aus der Abwasserüberwachung sind ein vom Testverhalten unabhängiger wichtiger Indikator. Abwasseranalysen von sechs Standorten[^27] bestätigen die basierend auf Fallzahlen beobachteten epidemiologischen Trends.



### Dynamik  
<!------- UPDATE -------->

Basierend auf den aktuellen Daten schätzen wir eine Abnahme der SARS-CoV-2 Epidemie. Der 7-Tageschnitt der schweizweiten Reproduktionszahl ist bei `r valueUIr(r_mean7d, uiText = "")`; dies reflektiert das Infektionsgeschehen vom `r r_mean7d_dateRange_str`[^1].



Tagesbasierte Schätzungen der effektiven Reproduktionszahl *R~e~* für die Schweiz betragen[^1]:

* `r valueUIr(r_cases, uiText = "95% Unsicherheitsintervall, UI")` aufgrund der bestätigten Fälle, per `r format(r_cases$date, "%d.%m.%Y")`.

* `r valueUIr(r_hosp)` aufgrund der Hospitalisationen, per `r format(r_hosp$date, "%d.%m.%Y")`.
Zum Vergleich aufgrund der bestätigten Fälle wird *R~e~* für den selben Tag auf `r valueUIr(r_cases_timeHosp)` geschätzt. 

* `r valueUIr(r_deaths)` aufgrund der Todesfälle, per `r format(r_deaths$date, "%d.%m.%Y")`.
Zum Vergleich aufgrund der Hospitalisationen wird *R~e~* für den selben Tag auf `r valueUIr(r_hosp_timeDeath)` geschätzt. 
Aufgrund der bestätigten Fälle wird *R~e~* für den selben Tag auf `r valueUIr(r_cases_timeDeath)` geschätzt.

Wegen Meldeverzögerungen und Fluktuationen in den Daten könnten die Schätzwerte nachkorrigiert werden.
Wir weisen darauf hin, dass die *R~e~* Werte das Infektionsgeschehen nur verzögert widerspiegeln, weil
eine gewisse Zeit vergeht zwischen der Infektion und dem Testresultat oder dem etwaigen Tod.
Für *R~e~* Werte, die auf Fallzahlen basieren, beträgt diese Verzögerung mindestens 10 Tage,
für Todesfälle bis 23 Tage.
Durch fortschreitende Impfungen erwarten wir, dass in den nächsten Wochen die Reproduktionszahl basierend auf Hospitalisierungen und Todesfällen die Transmissionsdynamik unterschätzt.

Parallel bestimmen wir die  Verdopplungs- bzw. Halbwertszeiten der bestätigten Fälle, Hospitalisationen und Todesfälle über die letzten 14 Tage[^2].
Die bestätigten Fälle änderten sich um `r valueUIchange(rankingCHEcases)` pro Woche,
die Hospitalisationen um `r valueUIchange(rankingCHEhospitalizations)`
und die Todesfälle um `r valueUIchange(rankingCHEdeaths)`.
Diese Werte spiegeln das Infektionsgeschehen vor mehreren Wochen wider.

Eine Veränderung der Fallzahlen, Hospitalisierungen und Todesfällen stratifiziert nach Alter kann auf unserem Dashboard verfolgt werden[^17].
Wir beobachten sinkende Hospitalisierungszahlen in allen Altersklassen.
Für die Gruppen der 55 bis 64-Jährigen, 65 bis 74-Jährigen, und über 75-Jährigen ist diese Reduktion statistisch signifikant.
<!------ UPDATE -------->
Der Effekt der Impfkampagne ist in der Altersgruppe über 75 Jahre sichtbar, wo wir einen Rückgang der Fallzahlen, Hospitalisierungen und Todesfälle beobachten. Während die Altersgruppe 75+ in der 2. Welle (November 2020) rund 50% der Hospitalisierungen ausgemacht hat, waren es im April 2021 noch rund 20%-25%. Dagegen sind die Hospitalisierungen bei den unter 65-jährigen von unter 30% in der 2. Welle (November 2020) auf über 60% im April 2021 gestiegen.
<!------ UPDATE -------->



### Absolute Zahlen
Die kumulierte Anzahl der bestätigten Fälle über die letzten 14 Tage liegt bei `r round(cases14d_CH$valueNorm14daySum, 0)` pro 100'000 Einwohner. 
Die Positivität liegt bei `r format(round(mostRecentTestPositivity$testPositivityP, positivityDigits), decimal.mark = ',')`% 
(Stand `r format(mostRecentTestPositivity$date, "%d.%m.%Y")`, das ist der letzte Tag für welchen nur noch wenige Nachmeldungen erwartet werden).
<!---- check if indeed 3 days ago. ie on Jan 10, we want to see positivity for Jan 7; to change in line 13---->

<!---- commented out as this is NOT Re based on positivity!
Tendenz `r positivityTrend`;  CHECK  
*R~e~* basierend auf Positivität für `r format(r_tests$date, "%d.%m.%Y")` ist `r valueUIr(r_tests)`). 
--->

Die Anzahl der COVID-19-Patienten auf Intensivstationen lag über die letzten 14 Tage
im Bereich von `r range(icu$count)[1]`-`r range(icu$count)[2]`[^3] Personen
(die Änderung war `r valueUIchange(rankingCHEicu)` pro Woche).

Die Zahl der täglichen laborbestätigten Todesfälle über die letzten 14 Tage war zwischen `r range(deaths$count)[1]` und `r range(deaths$count)[2]`[^4].
<!--- 
Seit dem 1. Oktober 2020 weist das Bundesamt für Gesundheit `r format(deaths_total, big.mark = "'")` laborbestätigte Todesfälle aus[^5].
Die Kantone meldeten in dieser Zeit `r format(corona_data_deaths, big.mark = "'")` Todesfälle[^6].
Die Sterblichkeitsstatistik vom Bundesamt für Statistik zeigt zwischen Kalenderwoche 43 im Jahr 2020 und Kalenderwoche 3 im Jahr 2021 eine Übersterblichkeit in der Altersgruppe 65 Jahre und älter[^7]. Insgesamt sind rund 8’400 zusätzliche Todesfälle in diesem Zeitraum im Vergleich zu Vorjahren verzeichnet. <!--- Seitdem wurde keine Übersterblichkeit mehr beobachtet.  CHECK 
Diese Übersterblichkeit nimmt ab, ist aber in den folgenden großen Regionen der Schweiz immer noch sichtbar: Ostschweiz, Zürich und Zentralschweiz[^8].  CHECK ---> 



## Neue Varianten
In der Schweiz sind die ursprünglich in Grossbritannien und Südafrika beschriebenen Varianten B.1.1.7 und B.1.351 erstmals
in Kalenderwoche 51 des Jahres 2020 identifiziert worden. Die ursprünglich in Brasilien beschriebene P.1 Variante wurde erstmals 
in Kalenderwoche 6 des Jahres 2021 in der Schweiz identifiziert. B.1.1.7 ist inzwischen die dominante Virusvariante und die Epidemie in der Schweiz ist eine B.1.1.7 Epidemie[^15],[^16].
B.1.351 und P.1 treten momentan mit jeweils weniger als 2% auf[^29].
<!--- UPDATE cov-spectrum.ethz.ch->"Surveillance" ---->
Die ursprünglich in Indien beschriebene B.1.617 Variante ist seit der 16. Kalenderwoche des Jahres 2021 in der Schweiz nachgewiesen. Die erste Probe mit dieser Variante ist auf die 11. Kalenderwoche datiert (wurde aber erst später in die Datenbank aufgenommen)[^29].
Bisher wurden weniger als 50 Fälle dieser Variante in der Schweiz nachgewiesen. Etwa 70% davon sind die Untervariante B.1.617.2, die Public Health England als "variant of concern (VOC)" klassifiziert hat.
<!--- UPDATE cov-spectrum.ethz.ch->"All samples" ---->

B.1.1.7 hat eine erhöhte Übertragungsrate. Dies hat dazu geführt, dass B.1.1.7 nun dominiert. Untersuchungen in Grossbritannien wiesen Ende 2020 darauf hin, dass B.1.1.7 eine deutlich höhere Übertragungsrate hat als die bislang bekannten Stämme von SARS-CoV-2[^13]. Die genetische Charakterisierung von Zufallsstichproben aus positiv getesteten Menschen von Testlabors der Schweiz, sowie die systematische genetische Charakterisierung von Proben im Referenzlabor in Genf, erlaubt diese erhöhte Übertragungsrate auch basierend auf schweizer Daten zu bestätigen[^18],[^16] (43-52% basierend auf [^18] und 42-60% basierend auf [^16]). <!--- check ---->

Das Risiko eines schweren Verlaufs aufgrund von Infektion mit B.1.1.7 wird in mehreren Studien beobachtet. Eine  Studie[^19] aus Grossbritannien deutet darauf hin, dass die Sterblichkeit bei einer Infektion mit B.1.1.7 um 50% erhöht ist über alle Altersklassen hinweg. Diese erhöhte Gefährlichkeit von B.1.1.7 wird gestützt durch weitere Studien aus Grossbritannien[^20],[^21]. Ergebnisse einer Studie[^22] aus Dänemark deuten darauf hin, dass das Risiko einer Hospitalisierung bei Infektion mit B.1.1.7 erhöht ist. Eine neue Studie sieht keine erhöhte Sterblichkeit, untersucht jedoch nur hospitalisierte Personen[^24]. In einer weiteren Studie bei der Daten einer «COVID symptom study App» ausgewertet wurden, wurde mit Ausbreitung von B.1.1.7 keine Verschiebung zu schwereren Verläufen beobachtet[^25].

In den schweizer Daten sehen wir einen Trend hin zu einem erhöhten Risiko einer Hospitalisierung wenn ein Patient mit B.1.1.7 infiziert ist[^29]. 
Dementsprechend sind mit Ausbreitung von B.1.1.7 die Wahrscheinlichkeiten einer Hospitalisierung bei positivem Testergebnis gestiegen.
Eine 50-59 jährige positiv getestete Person hat beispielsweise ein Risiko von 5.0% eines Spitaleintritts in 2021, wenn sie mit der Variante B.1.1.7 infiziert ist. Für eine Person, die mit einer anderen Variante infiziert ist, liegt dieses Risiko fast dreimal niedriger bei 1.7%[^29].
<!--- UPDATE https://cov-spectrum.ethz.ch/explore/Switzerland/Surveillance/Y2021/variants/json=%7B%22variant%22%3A%7B%22name%22%3A%22B.1.1.7%22%2C%22mutations%22%3A[]%7D%2C%22matchPercentage%22%3A1%7D/hospitalization-death ---->
Die anderen Altersgruppen über 35 entwickelten sich ähnlich (in den jüngeren Altersklassen sind die absoluten Zahlen zu klein für belastbare Aussagen).
Die Todesfall-Zahlen aufgrund von B.1.1.7 für die Schweiz sind zu klein, als dass wir für die Schweiz eine Aussage treffen könnten.

Es wird erwartet, dass die in der Schweiz momentan verwendeten mRNA-Impfstoffe auch gegen die neuen Varianten wirken [^23].

Basierend auf den Daten aus der genetischen Charakterisierung können wir die Veränderung der absoluten Fallzahlen, welche von B.1.1.7 verursacht werden, abschätzen.  Seit Anfang Januar bis Mitte April ist diese absolute Zahl kontinuierlich gestiegen während die anderen Varianten abgenommen haben[^15]. Die Gesamtzahlen haben bis Mitte Februar abgenommen. Seit März ist B.1.1.7 dominant und die Gesamtzahlen sind bis Mitte April gestiegen. Seitdem nehmen die Zahlen wieder ab. Diese Abnahme wird auch in unseren Nachbarstaaten beobachtet.



<!--- 
In Kalenderwoche `r mostRecentb117$week`, `r mostRecentb117$year` (ab dem `r format(mostRecentb117$weekStartDate, "%d.%m.%Y")`)
wurde die Häufigkeit von B.1.1.7 in der Schweiz auf etwa `r format(round(mostRecentb117$p, percentDigits), decimal.mark = ',')`% geschätzt
(95%-Unsicherheitsinterval `r format(round(mostRecentb117$p_lower, percentDigits), decimal.mark = ',')`% bis
`r format(round(mostRecentb117$p_upper, percentDigits), decimal.mark = ',')`%;
das reflektiert das Infektionsgeschehen etwa 10 Tage früher[^14]). Die Genfersee-Region ist in der Dynamik ca. 1-2 Wochen gegenüber der Gesamtscheiz voraus[^15],[^16].
Insbesondere steigt die absolute Anzahl der B.1.1.7 Infektionen. Diese Variante breitet sich momentan exponentiell mit einer Verdoppelung von ca. allen 2 Wochen aus[^14]. Dies bedeutet, dass die momentanen Massnahmen und deren Umsetzung  nicht ausreichen um die Ausbreitung von B.1.1.7 zu stoppen[^13].  CHECK --->


<!--- CHECK insert some summary in the weeks when we don't have a scientific update? the below might have to be updated! --->
<!--- ## Beurteilung 
Die SARS-CoV-2-Epidemie zeigt auf nationaler Ebene seit mehreren Wochen einen relativ stabilen Verlauf. Schweizweit liegt *R~e~* für all drei Indikatoren oberhalb des von der Swiss National COVID-19 Science Task Force vorgeschlagenen Zielwerts von 0,8. Durch die Einführung von national einheitlichen Massnahmen hat sich der Verlauf der Epidemie in den unterschiedlichen Regionen angeglichen. [^11] --->

<!--- Die kumulierte Anzahl der täglich bestätigten Fälle über die letzten 14 Tage liegt in allen Kantonen deutlich über der Schwelle von 60 pro 100'000 Einwohner. Die Testpositivität ist deutlich über dem von der Weltgesundheitsorganisation empfohlenen Schwellenwert von 5%. Die aktuelle Belastung für das Gesundheitssystem und die Zahl der täglichen Todesfälle ist in vielen Kantonen nach wie vor sehr hoch. Falls der Wintersport und die Festtage zu vermehrten Ansteckungen geführt haben, wird sich dies in einem Anstieg der bestätigten Fälle im Verlauf vom Januar niederschlagen. Zudem besteht das Risiko, dass eine Ausbreitung der bereits in der Schweiz nachgewiesenen neuen Variante von SARS-CoV-2 mit einer wahrscheinlich erhöhten Übertragung innerhalb der nächsten Wochen zu einem Anstieg der Epidemie und einer noch stärkeren Belastung des Gesundheitssystems führen wird.[^12] ---->

[^1]: https://sciencetaskforce.ch/reproduktionszahl/ und https://ibz-shiny.ethz.ch/covid-19-re-international/: Die Schätzungen von *R~e~* über die letzten Tage können leichten Schwankungen unterliegen. Diese Schwankungen treten insbesondere in kleinen Regionen, bei sich ändernder Dynamik und bei niederen Fallzahlen auf.
[^2]: https://ibz-shiny.ethz.ch/covidDashboard/trends: Aufgrund von Melderverzögerungen werden die letzten 3 respektive 5 Tage für bestätigte Fälle und Hospitalisationen/Todesfälle nicht berücksichtigt.
[^3]: https://icumonitoring.ch
[^4]: https://www.covid19.admin.ch
[^5]: https://www.covid19.admin.ch
[^6]: https://github.com/openZH/covid_19 und https://github.com/daenuprobst/covid19-cases-switzerland
[^7]: https://www.bfs.admin.ch/bfs/de/home/statistiken/gesundheit/gesundheitszustand/sterblichkeit-todesursachen.html
[^8]: https://www.experimental.bfs.admin.ch/expstat/de/home/innovative-methoden/momo.html
[^9]: https://sciencetaskforce.ch/beurteilung-der-lage-13-november-2020
[^10]: https://ibz-shiny.ethz.ch/covidDashboard/tables
[^11]: https://sciencetaskforce.ch/reproduktionszahl/ und https://ibz-shiny.ethz.ch/covid-19-re-international/
[^12]: https://www.ecdc.europa.eu/en/publications-data/threat-assessment-brief-rapid-increase-sars-cov-2-variant-united-kingdom
[^13]: https://sciencetaskforce.ch/wissenschaftliches-update-09-februar-2021/
[^14]: https://sciencetaskforce.ch/nextstrain-phylogentische-analysen/
[^15]: https://cevo-public.github.io/Quantification-of-the-spread-of-a-SARS-CoV-2-variant/
[^16]: https://ispmbern.github.io/covid-19/variants/
[^17]: https://ibz-shiny.ethz.ch/covidDashboard/, Dashboard Time Series
[^18]: https://www.medrxiv.org/content/10.1101/2021.03.05.21252520v2
[^19]: https://www.nature.com/articles/s41586-021-03426-1
[^20]: https://www.bmj.com/content/bmj/372/bmj.n579.full.pdf
[^21]: https://www.medrxiv.org/content/10.1101/2021.03.04.21252528v2.full.pdf
[^22]: https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3792894
[^23]: https://sciencetaskforce.ch/wissenschaftliches-update-07-april-2021/
[^24]: https://www.thelancet.com/journals/laninf/article/PIIS1473-3099(21)00170-5/fulltext
[^25]: https://www.thelancet.com/journals/lanpub/article/PIIS2468-2667(21)00055-4/fulltext
[^26]: http://parsivel-eawag.ch/sarscov2/ARA_Werdhoelzli_ddPCR.html
[^27]: https://sensors-eawag.ch/sars/overview.html
[^28]: https://cov-spectrum.ethz.ch/explore/Switzerland/Surveillance/AllTimes/
[^29]: https://cov-spectrum.ethz.ch/


<!---- deleted stuff! ---->

```{r regional, echo = FALSE}
regional <- subset(reproduction,
                    (grepl("grR", region))
                    & data_type == "Confirmed cases"
                    & estimate_type == "Cori_slidingWindow")

regional <- regional[regional$date == max(regional$date), ]
regional <- regional[order(regional$median_R_mean), ]

regional$region[regional$region == "grR Central Switzerland"] <- "Zentralschweiz"
regional$region[regional$region == "grR Eastern Switzerland"] <- "Ostschweiz"
regional$region[regional$region == "grR Espace Mittelland"] <- "Espace Mittelland"
regional$region[regional$region == "grR Lake Geneva Region"] <- "Région lémanique"
regional$region[regional$region == "grR Northwestern Switzerland"] <- "Nordwestschweiz"
regional$region[regional$region == "grR Ticino"] <- "Ticino"
regional$region[regional$region == "grR Zurich"] <- "Zürich"

threshold <- 0.8

regional_below <- regional[regional$median_R_mean <= threshold, ]
below <- ""
for(i in 1:dim(regional_below)[1]) {
  ifelse(i < dim(regional_below)[1], last <- ", ", last <- "")
  below <- paste0(below,
                  regional_below$region[i], 
                  " mit ",
                  format(round(regional_below$median_R_mean[i], 2), decimal.mark = ","),
                  "; 95% UI: ",
                  format(round(regional_below$median_R_lowHPD[i], 2), decimal.mark = ","),
                  "-",
                  format(round(regional_below$median_R_highHPD[i], 2), decimal.mark = ","),
                  last)
}

regional_above <- regional[regional$median_R_mean > threshold, ]
above <- ""
for(i in 1:dim(regional_above)[1]) {
  ifelse(i < dim(regional_above)[1], last <- "), ", last <- ")")
  above <- paste0(above,
                  regional_above$region[i], 
                  " (",
                  format(round(regional_above$median_R_mean[i], 2), decimal.mark = ","),
                  "; 95% UI: ",
                  format(round(regional_above$median_R_lowHPD[i], 2), decimal.mark = ","),
                  "-",
                  format(round(regional_above$median_R_highHPD[i], 2), decimal.mark = ","),
                  last)
}
```

<!---- ## Regionale Unterschiede
Es bestehen regionale und kantonale Unterschiede im Verlauf der SARS-CoV-2-Epidemie. Die kumulierte Anzahl der täglich bestätigten Fälle über die letzten 14 Tage pro 100'000 Einwohner liegt zwischen `r round(cases14d_min$valueNorm14daySum, 0)` (`r cases14d_min$regionName`) und `r round(cases14d_max$valueNorm14daySum, 0)` (`r cases14d_max$regionName`). In allen 7 Grossregionen liegt *R~e~* aufgrund der bestätigten Fälle (Median) derzeit über dem von der Swiss National COVID-19 Science Task Force vorgeschlagenen Zielwert von 0,8, welcher zu einer Halbierung der Anzahl Neuinfektionen innerhalb maximal 14 Tagen führt:[^9] `r above`. Die Werte von *R~e~* können auf kantonaler Ebene auch innerhalb einer Grossregion grössere Unterschiede aufweisen.[^10] --->
